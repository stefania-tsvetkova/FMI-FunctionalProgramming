# Homework2

Ще разглеждаме система за управление на туристическа агенция. Една такава агенция (Agency) има списък от клиенти. Всеки клиент (Customer) има име (символен низ), списък от екскурзии, на които е бил/ще бъде, и брой точки (естествено число) по програмата за лоялни клиенти на агенцията. Всяка екскурзия (Trip) има дестинация (символен низ), цена (дробно число), статус и списък от развлечения. Статусът (Status) на всяка една екскурзия
може да бъде предстояща (Upcoming), отменена (Canceled), текуща (InProgress) или приключила (Finished). Всяко развлечение (Activity) се описва с име (символен низ) и продължителност в минути (положително цяло число).

а) За Коледа агенцията е решила да подари на всички свои лоялни клиенти една безплатна екскурзия. Печеливши са всички клиенти, които са изхарчили за екскурзии повече от определена сума пари, прекарали са повече от определен брой часове по екскурзии с фирмата (продължителността на една ексурзия е сума от продължителностите на всяко едно развлечение в нея), имат над определен брой точки по програмата за лоялни клиенти, никога не са отменяли почивка и не са посещавали една и съща дестинация повече от веднъж. Праговите стойности ще обединим в един запис. Той включва долна граница за изхарчените пари, долна граница за прекараното време и долна граница за точките по програмата за лоялни клиенти.

```
data Thresholds = Thresholds { 
  moneyThreshold :: ?, 
  durationThreshold :: ?,
  loyaltyPointsThreshold :: ? 
}
```

Агенцията има нужда от вашата помощ, за да разбере кои са печелившите клиенти. Напишете функция `freeTripEligibleCustomers agency thresholds`, която приема туристическа агенция и запис с прагови стойности (Thresholds), и връща списък от тези клиенти, които имат право на безплатна почивка.

б) Логиката за отмяна на екскурзия затруднява служителите в туристическата агенция, затова те имат нужда от помощ. За всяка екскурзия фирмата има различна политика при отменяне, която може да бъде гъвкава (Flexible), умерена (Moderate) или строга (Strict). Екскурзия може да бъде отменена само и единствено, ако тя не е започнала или ако е започнала, но не е приключила. При отмяна на екскурзия, ако тя не е започнала, клиентът имат право да получи част от парите си обратно. Ако екскурзията вече е започнала, то клиентът не получава пари обратно. Парите, които клиентът може да получи, ако екскурзията не е започнала, се изчисляват по следната формула: 

refund = max(k * c * price – fee, 0)

където:


price = цената на екскурзията <br/>
k = (брой всички неотказани екскурзии на клиента) / (брой всички екскурзии на клиента) <br/>
c = 0.7 при Flexible, 0.4 при Moderate и 0.1 при Strict <br/>
fee = quotient * canceledAvg <br/>
canceledAvg = средно аритметично на цените на всички екскурзии, които клиентът е отказал до момента (без текущата) <br/>
quotient = (брой отказали се от екскурзията) / (брой на всички записали се за екскурзията) *,**

\* В броя на отказалите се клиенти се включва и текущия клиент <br/>
** Една екскурзия е уникална комбинация от дестинация, развлечения и цена

Да се напише функция `getRefund agency customerName destination` която получава като аргументи агенцията, името на клиента и дестинацията на екскурзията. Функцията трябва да върне Nothing, ако екскурзията не може да бъде отказана или Just refund, където refund е размерът на сумата, която трябва да бъде възстановена.***

*** Допускаме, че customerName и destination винаги ще определят най-много една екскурзия, която може да бъде отменена
